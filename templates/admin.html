{% extends 'base.html' %}

{% block content %}
  <div class="container">
    <h1>Admin Page</h1>
    <h2>Add User</h2>
    <form method="POST" action="{{ url_for('add_user') }}">
      <table>
        <tr>
          <td><label for="username">Username:</label></td>
          <td><input type="text" name="username" required></td>
        </tr>
        <tr>
          <td><label for="password">Password:</label></td>
          <td><input type="text" name="password" id="password" required><br /><br />
          <button type="button" id="generate-password">Generate</button></td>
        </tr>
        <tr>
          <td><label for="status">Status:</label></td>
          <td>
            <select name="status" required>
              <option value="member" selected>Member</option>
              <option value="admin">Admin</option>
              <option value="pending">Pending</option>
            </select>
          </td>
        </tr>
        <tr>
          <td></td>
          <td><input type="submit" value="Add User"></td>
        </tr>
      </table>
    </form>


    <hr>

    <h2>Edit Users</h2>
    <table>
      <thead>
        <tr>
          <th>Username</th>
          <th>Password</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
      {% for user in users %}
          <tr>
            <td>{{ user.username }}</td>
            <td onclick="this.innerHTML='{{ user.password }}';">{{ '*' * 5 }}</td>
            <td>{{ user.status }}</td>
            <td><a href="{{ url_for('edit_user', username=user.username) }}">Edit</a></td>
          </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}
{% block scripts %}
  <script type="text/javascript" src="{{ url_for('static', filename='js/scripts.js') }}"></script>
  <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function() {
      var generatePasswordBtn = document.getElementById('generate-password');
      var passwordField = document.getElementById('password');

      generatePasswordBtn.addEventListener('click', function() {
        var phoneticLetters = ['alpha', 'bravo', 'charlie', 'delta', 'echo', 'foxtrot', 'golf', 'hotel', 'india', 'juliet', 'kilo', 'lima', 'mike', 'november', 'oscar', 'papa', 'quebec', 'romeo', 'sierra', 'tango', 'uniform', 'victor', 'whiskey', 'xray', 'yankee', 'zulu'];
        var firstLetter = phoneticLetters[Math.floor(Math.random() * phoneticLetters.length)];
        var secondLetter = phoneticLetters[Math.floor(Math.random() * phoneticLetters.length)];
        var digits = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
        var password = firstLetter + digits + secondLetter;
        passwordField.value = password;
      });
    });
  </script>
{% endblock %}
